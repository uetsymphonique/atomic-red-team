{
  "attack_technique": "T1070.008",
  "display_name": "Email Collection: Mailbox Manipulation",
  "atomic_tests": [
    {
      "name": "Copy and Delete Mailbox Data on Windows",
      "description": "Copies and deletes mail data on Windows",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "cleanup_command": "Remove-Item -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -Recurse -Force -ErrorAction Ignore",
        "procedure": "New-Item -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -ItemType Directory -ErrorAction Ignore\nGet-ChildItem -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\" -Exclude copy | ForEach-Object { Copy-Item -Path $_.FullName -Destination \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -Recurse -Force -ErrorAction Ignore }\nRemove-Item -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -Recurse -Force -ErrorAction Ignore"
      },
      "input_arguments": [],
      "auto_generated_guid": "d29f01ea-ac72-4efc-8a15-bea64b77fabf"
    },
    {
      "name": "Copy and Delete Mailbox Data on Linux",
      "description": "Copies and deletes mail data on Linux",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "rm -rf /var/spool/mail/copy\nif [ -f \"$(ls -A /var/spool/mail/temp)\" ]; then rm /var/spool/mail/temp; fi",
        "procedure": "mkdir -p /var/spool/mail/copy && for file in /var/spool/mail/*; do if [ \"$(basename \"$file\")\" != \"copy\" ]; then cp -R \"$file\" /var/spool/mail/copy/; fi; done && rm -rf /var/spool/mail/copy/*"
      },
      "input_arguments": [],
      "dependencies": [
        {
          "description": "Create dummy file in /var/spool/mail/ if no files exist",
          "prereq_command": "if [ -z \"$(ls -A /var/spool/mail/)\" ]; then exit 1; else exit 0; fi",
          "get_prereq_command": "if [ -z \"$(ls -A /var/spool/mail/)\" ]; then touch /var/spool/mail/temp; fi"
        }
      ],
      "auto_generated_guid": "25e2be0e-96f7-4417-bd16-a4a2500e3802"
    },
    {
      "name": "Copy and Delete Mailbox Data on macOS",
      "description": "Copies and deletes mail data on macOS",
      "supported_platforms": [
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "rm -rf ~/Library/Mail/copy",
        "procedure": "mkdir ~/Library/Mail/copy\ncp -R ~/Library/Mail/* ~/Library/Mail/copy\nrm -rf ~/Library/Mail/copy/*"
      },
      "input_arguments": [],
      "auto_generated_guid": "3824130e-a6e4-4528-8091-3a52eeb540f6"
    },
    {
      "name": "Copy and Modify Mailbox Data on Windows",
      "description": "Copies and modifies mail data on Windows",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "cleanup_command": "Remove-Item -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -Recurse -Force -ErrorAction Ignore",
        "procedure": "New-Item -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -ItemType Directory -ErrorAction Ignore\nGet-ChildItem -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\" -Exclude copy | ForEach-Object { Copy-Item -Path $_.FullName -Destination \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -Recurse -Force -ErrorAction Ignore }\nGet-ChildItem -Path \"C:\\Users\\$env:USERNAME\\AppData\\Local\\Comms\\Unistore\\data\\copy\" -File | ForEach-Object { Add-Content -Path $_.FullName -Value \"Modification for Atomic Red Test\" -ErrorAction Ignore }"
      },
      "input_arguments": [],
      "auto_generated_guid": "edddff85-fee0-499d-9501-7d4d2892e79b"
    },
    {
      "name": "Copy and Modify Mailbox Data on Linux",
      "description": "Copies and modifies mail data on Linux",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "rm -rf /var/spool/mail/copy\nif [ -f \"$(ls -A /var/spool/mail/temp)\" ]; then rm /var/spool/mail/temp; fi",
        "procedure": "mkdir -p /var/spool/mail/copy; for file in /var/spool/mail/*; do if [ \"$(basename \"$file\")\" != \"copy\" ]; then cp -R \"$file\" /var/spool/mail/copy/; if [ -f \"/var/spool/mail/copy/$(basename \"$file\")\" ]; then echo \"Modification for Atomic Red Test\" >> \"/var/spool/mail/copy/$(basename \"$file\")\"; fi; fi; done"
      },
      "input_arguments": [],
      "dependencies": [
        {
          "description": "Create dummy file in /var/spool/mail/ if no files exist",
          "prereq_command": "if [ -z \"$(ls -A /var/spool/mail/)\" ]; then exit 1; else exit 0; fi",
          "get_prereq_command": "if [ -z \"$(ls -A /var/spool/mail/)\" ]; then touch /var/spool/mail/temp; fi"
        }
      ],
      "auto_generated_guid": "6d99f93c-da56-49e3-b195-163090ace4f6"
    },
    {
      "name": "Copy and Modify Mailbox Data on macOS",
      "description": "Copies and modifies mail data on macOS",
      "supported_platforms": [
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "rm -rf ~/Library/Mail/copy",
        "procedure": "mkdir ~/Library/Mail/copy\ncp -R ~/Library/Mail/* ~/Library/Mail/copy\necho \"Manipulated data\" > ~/Library/Mail/copy/manipulated.txt"
      },
      "input_arguments": [],
      "auto_generated_guid": "8a0b1579-5a36-483a-9cde-0236983e1665"
    }
  ]
}