{
  "attack_technique": "T1123",
  "display_name": "Audio Capture",
  "atomic_tests": [
    {
      "name": "using device audio capture commandlet",
      "description": "Uses AudioDeviceCmdlets to set the default recording device and simulate audio capture.\nModule repo: [AudioDeviceCmdlets](https://github.com/frgnca/AudioDeviceCmdlets)",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "$mic = Get-AudioDevice -Recording\nSet-AudioDevice -ID $mic.ID\nStart-Sleep -Seconds 5"
      },
      "input_arguments": [],
      "dependencies": [
        {
          "description": "AudioDeviceCmdlets module must be installed",
          "prereq_command": "if (Get-Module -ListAvailable -Name AudioDeviceCmdlets) { exit 0 } else { exit 1 }",
          "get_prereq_command": "Install with: Install-Module -Name AudioDeviceCmdlets -Force\""
        }
      ],
      "auto_generated_guid": "9c3ad250-b185-4444-b5a9-d69218a10c95"
    },
    {
      "name": "Registry artefact when application use microphone",
      "description": "[can-you-track-processes-accessing-the-camera-and-microphone](https://svch0st.medium.com/can-you-track-processes-accessing-the-camera-and-microphone-7e6885b37072)",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "cleanup_command": "reg DELETE HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged\\C:#Windows#Temp#atomic.exe /f",
        "procedure": "reg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged\\C:#Windows#Temp#atomic.exe /v LastUsedTimeStart /t REG_BINARY /d a273b6f07104d601 /f\nreg add HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone\\NonPackaged\\C:#Windows#Temp#atomic.exe /v LastUsedTimeStop /t REG_BINARY /d 96ef514b7204d601 /f"
      },
      "input_arguments": [],
      "auto_generated_guid": "7a21cce2-6ada-4f7c-afd9-e1e9c481e44a"
    },
    {
      "name": "using Quicktime Player",
      "description": "Use AppleScript to get Quicktime Player to record an audio file from the default microphone.\n\nShould create a non-empty m4a file with sound from the microphone.\n\n- requires Automation permissions but no additional microphone permissions\n- saves file in /tmp by default. Other locations likely to require more permissions.",
      "supported_platforms": [
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "cleanup_command": "if test -w #{audiofile}; then\n  rm #{audiofile}\nfi",
        "procedure": "sh #{filename} #{audiofile} #{duration}"
      },
      "input_arguments": [
        {
          "arg_name": "filename",
          "description": "Location of the script",
          "type": "path",
          "default": "PathToAtomicsFolder/T1123/src/T1123.sh"
        },
        {
          "arg_name": "audiofile",
          "description": "Location of the recorded audio file",
          "type": "path",
          "default": "/tmp/T1123.m4a"
        },
        {
          "arg_name": "duration",
          "description": "Length of recording to make in seconds",
          "type": "integer",
          "default": "5"
        }
      ],
      "auto_generated_guid": "c7a0bb71-70ce-4a53-b115-881f241b795b"
    }
  ]
}