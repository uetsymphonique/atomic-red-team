{
  "attack_technique": "T1007",
  "display_name": "System Service Discovery",
  "atomic_tests": [
    {
      "name": "System Service Discovery",
      "description": "Identify system services.\n\nUpon successful execution, cmd.exe will execute service commands with expected result to stdout.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "procedure": "tasklist.exe\nsc query\nsc query state= all"
      },
      "input_arguments": [],
      "auto_generated_guid": "89676ba1-b1f8-47ee-b940-2e1a113ebc71"
    },
    {
      "name": "System Service Discovery - net.exe",
      "description": "Enumerates started system services using net.exe and writes them to a file. This technique has been used by multiple threat actors.\n\nUpon successful execution, net.exe will run from cmd.exe that queries services. Expected output is to a txt file in in the temp directory called service-list.txt.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "cleanup_command": "del /f /q /s #{output_file} >nul 2>&1",
        "procedure": "net.exe start >> #{output_file}"
      },
      "input_arguments": [
        {
          "arg_name": "output_file",
          "description": "Path of file to hold net.exe output",
          "type": "path",
          "default": "%temp%\\service-list.txt"
        }
      ],
      "auto_generated_guid": "5f864a3f-8ce9-45c0-812c-bdf7d8aeacc3"
    },
    {
      "name": "System Service Discovery - systemctl/service",
      "description": "Enumerates system service using systemctl/service",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "if [ \"$(uname)\" = 'FreeBSD' ]; then service -e; else systemctl --type=service; fi;"
      },
      "input_arguments": [],
      "auto_generated_guid": "f4b26bce-4c2c-46c0-bcc5-fce062d38bef"
    },
    {
      "name": "Get-Service Execution",
      "description": "Executes the Get-Service cmdlet to gather objects representing all services on the local system.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "procedure": "powershell.exe Get-Service"
      },
      "input_arguments": [],
      "auto_generated_guid": "51f17016-d8fa-4360-888a-df4bf92c4a04"
    }
  ]
}