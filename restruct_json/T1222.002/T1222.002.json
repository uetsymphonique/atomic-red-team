{
  "attack_technique": "T1222.002",
  "display_name": "File and Directory Permissions Modification: FreeBSD, Linux and Mac File and Directory Permissions Modification",
  "atomic_tests": [
    {
      "name": "chmod - Change file or folder mode (numeric mode)",
      "description": "Changes a file or folder's permissions using chmod and a specified numeric mode.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "chmod #{numeric_mode} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "numeric_mode",
          "description": "Specified numeric mode value",
          "type": "integer",
          "default": "755"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        }
      ],
      "auto_generated_guid": "34ca1464-de9d-40c6-8c77-690adf36a135"
    },
    {
      "name": "chmod - Change file or folder mode (symbolic mode)",
      "description": "Changes a file or folder's permissions using chmod and a specified symbolic mode.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "chmod #{symbolic_mode} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "symbolic_mode",
          "description": "Specified symbolic mode value",
          "type": "string",
          "default": "a+w"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        }
      ],
      "auto_generated_guid": "fc9d6695-d022-4a80-91b1-381f5c35aff3"
    },
    {
      "name": "chmod - Change file or folder mode (numeric mode) recursively",
      "description": "Changes a file or folder's permissions recursively using chmod and a specified numeric mode.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "chmod -R #{numeric_mode} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "numeric_mode",
          "description": "Specified numeric mode value",
          "type": "integer",
          "default": "755"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        }
      ],
      "auto_generated_guid": "ea79f937-4a4d-4348-ace6-9916aec453a4"
    },
    {
      "name": "chmod - Change file or folder mode (symbolic mode) recursively",
      "description": "Changes a file or folder's permissions recursively using chmod and a specified symbolic mode.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "chmod -R #{symbolic_mode} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "symbolic_mode",
          "description": "Specified symbolic mode value",
          "type": "string",
          "default": "a+w"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        }
      ],
      "auto_generated_guid": "0451125c-b5f6-488f-993b-5a32b09f7d8f"
    },
    {
      "name": "chown - Change file or folder ownership and group",
      "description": "Changes a file or folder's ownership and group information using chown.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "chown #{owner}:#{group} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "owner",
          "description": "Username of desired owner",
          "type": "string",
          "default": "root"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002/T1222.002.yaml"
        },
        {
          "arg_name": "group",
          "description": "Group name of desired group",
          "type": "string",
          "default": "root"
        }
      ],
      "auto_generated_guid": "d169e71b-85f9-44ec-8343-27093ff3dfc0"
    },
    {
      "name": "chown - Change file or folder ownership and group recursively",
      "description": "Changes a file or folder's ownership and group information recursively using chown.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "chown -R #{owner}:#{group} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "owner",
          "description": "Username of desired owner",
          "type": "string",
          "default": "root"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        },
        {
          "arg_name": "group",
          "description": "Group name of desired group",
          "type": "string",
          "default": "root"
        }
      ],
      "auto_generated_guid": "b78598be-ff39-448f-a463-adbf2a5b7848"
    },
    {
      "name": "chown - Change file or folder mode ownership only",
      "description": "Changes a file or folder's ownership only using chown.",
      "supported_platforms": [
        "linux",
        "macos"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "chown #{owner} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "owner",
          "description": "Username of desired owner",
          "type": "string",
          "default": "root"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002/T1222.002.yaml"
        }
      ],
      "auto_generated_guid": "967ba79d-f184-4e0e-8d09-6362b3162e99"
    },
    {
      "name": "chown - Change file or folder ownership recursively",
      "description": "Changes a file or folder's ownership only recursively using chown.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "bash",
        "elevation_required": false,
        "procedure": "chown -R #{owner} #{file_or_folder}"
      },
      "input_arguments": [
        {
          "arg_name": "owner",
          "description": "Username of desired owner",
          "type": "string",
          "default": "root"
        },
        {
          "arg_name": "file_or_folder",
          "description": "Path of the file or folder",
          "type": "path",
          "default": "/tmp/AtomicRedTeam/atomics/T1222.002"
        }
      ],
      "auto_generated_guid": "3b015515-b3d8-44e9-b8cd-6fa84faf30b2"
    },
    {
      "name": "chattr - Remove immutable file attribute",
      "description": "Remove's a file's `immutable` attribute using `chattr`.\nThis technique was used by the threat actor Rocke during the compromise of Linux web servers.",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "chattr -i #{file_to_modify}"
      },
      "input_arguments": [
        {
          "arg_name": "file_to_modify",
          "description": "Path of the file",
          "type": "path",
          "default": "/var/spool/cron/root"
        }
      ],
      "auto_generated_guid": "e7469fe2-ad41-4382-8965-99b94dd3c13f"
    },
    {
      "name": "chflags - Remove immutable file attribute",
      "description": "Remove's a file's `immutable` attribute using `chflags`.\nThis technique was used by the threat actor Rocke during the compromise of Linux web servers.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "touch #{file_to_modify}\nchflags simmutable #{file_to_modify}\nchflags nosimmutable #{file_to_modify}"
      },
      "input_arguments": [
        {
          "arg_name": "file_to_modify",
          "description": "Path of the file",
          "type": "path",
          "default": "/tmp/T1222.002.txt"
        }
      ],
      "auto_generated_guid": "60eee3ea-2ebd-453b-a666-c52ce08d2709"
    },
    {
      "name": "Chmod through c script",
      "description": "chmods a file using a c script",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "#{compiled_file} /tmp/ T1222002"
      },
      "input_arguments": [
        {
          "arg_name": "source_file",
          "description": "Path of c source file",
          "type": "path",
          "default": "PathToAtomicsFolder/T1222.002/src/T1222.002.c"
        },
        {
          "arg_name": "compiled_file",
          "description": "Path of compiled file",
          "type": "path",
          "default": "/tmp/T1222002"
        }
      ],
      "dependencies": [
        {
          "description": "Compile the script from (#{source_file}). Destination is #{compiled_file}",
          "prereq_command": "gcc #{source_file} -o #{compiled_file}",
          "get_prereq_command": "gcc #{source_file} -o #{compiled_file}"
        }
      ],
      "auto_generated_guid": "973631cf-6680-4ffa-a053-045e1b6b67ab"
    },
    {
      "name": "Chmod through c script (freebsd)",
      "description": "chmods a file using a c script",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": false,
        "procedure": "#{compiled_file} /tmp/ T1222002"
      },
      "input_arguments": [
        {
          "arg_name": "source_file",
          "description": "Path of c source file",
          "type": "path",
          "default": "PathToAtomicsFolder/T1222.002/src/T1222.002.c"
        },
        {
          "arg_name": "compiled_file",
          "description": "Path of compiled file",
          "type": "path",
          "default": "/tmp/T1222002"
        }
      ],
      "dependencies": [
        {
          "description": "Compile the script from (#{source_file}). Destination is #{compiled_file}",
          "prereq_command": "cc #{source_file} -o #{compiled_file}",
          "get_prereq_command": "cc #{source_file} -o #{compiled_file}"
        }
      ],
      "auto_generated_guid": "da40b5fe-3098-4b3b-a410-ff177e49ee2e"
    },
    {
      "name": "Chown through c script",
      "description": "chowns a file to root using a c script",
      "supported_platforms": [
        "macos",
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "procedure": "sudo #{compiled_file} #{source_file}"
      },
      "input_arguments": [
        {
          "arg_name": "source_file",
          "description": "Path of c source file",
          "type": "path",
          "default": "PathToAtomicsFolder/T1222.002/src/chown.c"
        },
        {
          "arg_name": "compiled_file",
          "description": "Path of compiled file",
          "type": "path",
          "default": "/tmp/T1222002own"
        }
      ],
      "dependencies": [
        {
          "description": "Compile the script from (#{source_file}). Destination is #{compiled_file}",
          "prereq_command": "gcc #{source_file} -o #{compiled_file}",
          "get_prereq_command": "gcc #{source_file} -o #{compiled_file}"
        }
      ],
      "auto_generated_guid": "18592ba1-5f88-4e3c-abc8-ab1c6042e389"
    },
    {
      "name": "Chown through c script (freebsd)",
      "description": "chowns a file to root using a c script",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "procedure": "#{compiled_file} #{source_file}"
      },
      "input_arguments": [
        {
          "arg_name": "source_file",
          "description": "Path of c source file",
          "type": "path",
          "default": "PathToAtomicsFolder/T1222.002/src/chown.c"
        },
        {
          "arg_name": "compiled_file",
          "description": "Path of compiled file",
          "type": "path",
          "default": "/tmp/T1222002own"
        }
      ],
      "dependencies": [
        {
          "description": "Compile the script from (#{source_file}). Destination is #{compiled_file}",
          "prereq_command": "cc #{source_file} -o #{compiled_file}",
          "get_prereq_command": "cc #{source_file} -o #{compiled_file}"
        }
      ],
      "auto_generated_guid": "eb577a19-b730-4918-9b03-c5edcf51dc4e"
    }
  ]
}