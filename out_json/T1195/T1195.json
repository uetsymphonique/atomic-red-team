{
  "attack_technique": "T1195",
  "display_name": "Supply Chain Compromise",
  "atomic_tests": [
    {
      "name": "Octopus Scanner Malware Open Source Supply Chain",
      "description": "This test simulates an adversary Octopus drop the RAT dropper ExplorerSync.db\n[octopus-scanner-malware-open-source-supply-chain](https://securitylab.github.com/research/octopus-scanner-malware-open-source-supply-chain/)\n[the-supreme-backdoor-factory](https://www.dfir.it/blog/2019/02/26/the-supreme-backdoor-factory/)",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "copy %temp%\\ExplorerSync.db %temp%\\..\\Microsoft\\ExplorerSync.db\nschtasks /create /tn ExplorerSync /tr \"javaw -jar %temp%\\..\\Microsoft\\ExplorerSync.db\" /sc MINUTE /f",
        "cleanup_command": "schtasks /delete /tn ExplorerSync /F 2>null\ndel %temp%\\..\\Microsoft\\ExplorerSync.db 2>null\ndel %temp%\\ExplorerSync.db 2>null"
      },
      "input_arguments": {
        "rat_payload": {
          "description": "RAT dropper ExplorerSync.db",
          "type": "path",
          "default": "$env:TEMP\\ExplorerSync.db"
        }
      },
      "dependencies": [
        {
          "description": "ExplorerSync.db must exist on disk at specified location (#{rat_payload})",
          "prereq_command": "if (Test-Path #{rat_payload}) {exit 0} else {exit 1}",
          "get_prereq_command": "Out-File -FilePath \"#{rat_payload}\""
        }
      ],
      "dependency_executor_name": "powershell",
      "auto_generated_guid": "82a9f001-94c5-495e-9ed5-f530dbded5e2"
    }
  ]
}