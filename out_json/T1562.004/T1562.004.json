{
  "attack_technique": "T1562.004",
  "display_name": "Impair Defenses: Disable or Modify System Firewall",
  "atomic_tests": [
    {
      "name": "Disable Microsoft Defender Firewall",
      "description": "Disables the Microsoft Defender Firewall for the current profile.\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "netsh advfirewall set currentprofile state off",
        "cleanup_command": "netsh advfirewall set currentprofile state on >nul 2>&1"
      },
      "input_arguments": {},
      "auto_generated_guid": "88d05800-a5e4-407e-9b53-ece4174f197f"
    },
    {
      "name": "Disable Microsoft Defender Firewall via Registry",
      "description": "Disables the Microsoft Defender Firewall for the public profile via registry\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will re-enable firewall for the current profile...",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 0 /f",
        "cleanup_command": "reg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\" /v \"EnableFirewall\" /t REG_DWORD /d 1 /f"
      },
      "input_arguments": {},
      "auto_generated_guid": "afedc8c4-038c-4d82-b3e5-623a95f8a612"
    },
    {
      "name": "Allow SMB and RDP on Microsoft Defender Firewall",
      "description": "Allow all SMB and RDP rules on the Microsoft Defender Firewall for all profiles.\nCaution if you access remotely the host where the test runs! Especially with the cleanup command which will reset the firewall and risk disabling those services...",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "netsh advfirewall firewall set rule group=\"remote desktop\" new enable=Yes\nnetsh advfirewall firewall set rule group=\"file and printer sharing\" new enable=Yes",
        "cleanup_command": "netsh advfirewall reset >nul 2>&1"
      },
      "input_arguments": {},
      "auto_generated_guid": "d9841bf8-f161-4c73-81e9-fd773a5ff8c1"
    },
    {
      "name": "Opening ports for proxy - HARDRAIN",
      "description": "This test creates a listening interface on a victim device. This tactic was used by HARDRAIN for proxying.\n\nreference: https://www.us-cert.gov/sites/default/files/publications/MAR-10135536-F.pdf",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "command": "netsh advfirewall firewall add rule name=\"atomic testing\" action=allow dir=in protocol=TCP localport=450",
        "cleanup_command": "netsh advfirewall firewall delete rule name=\"atomic testing\" protocol=TCP localport=450 >nul 2>&1"
      },
      "input_arguments": {},
      "auto_generated_guid": "15e57006-79dd-46df-9bf9-31bc24fb5a80"
    },
    {
      "name": "Open a local port through Windows Firewall to any profile",
      "description": "This test will attempt to open a local port defined by input arguments to any profile",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "netsh advfirewall firewall add rule name=\"Open Port to Any\" dir=in protocol=tcp localport=#{local_port} action=allow profile=any",
        "cleanup_command": "netsh advfirewall firewall delete rule name=\"Open Port to Any\" | Out-Null"
      },
      "input_arguments": {
        "local_port": {
          "description": "This is the local port you wish to test opening",
          "type": "integer",
          "default": "3389"
        }
      },
      "auto_generated_guid": "9636dd6e-7599-40d2-8eee-ac16434f35ed"
    },
    {
      "name": "Allow Executable Through Firewall Located in Non-Standard Location",
      "description": "This test will attempt to allow an executable through the system firewall located in the Users directory",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "Copy-Item \"#{exe_file_path}\" -Destination \"C:\\Users\\$env:UserName\" -Force\nnetsh advfirewall firewall add rule name=\"Atomic Test\" dir=in action=allow program=\"C:\\Users\\$env:UserName\\AtomicTest.exe\" enable=yes",
        "cleanup_command": "netsh advfirewall firewall delete rule name=\"Atomic Test\" | Out-Null\nRemove-Item C:\\Users\\$env:UserName\\AtomicTest.exe -ErrorAction Ignore"
      },
      "input_arguments": {
        "exe_file_path": {
          "description": "path to exe file",
          "type": "path",
          "default": "PathToAtomicsFolder\\T1562.004\\bin\\AtomicTest.exe"
        }
      },
      "auto_generated_guid": "6f5822d2-d38d-4f48-9bfc-916607ff6b8c"
    },
    {
      "name": "Stop/Start UFW firewall",
      "description": "Stop the Uncomplicated Firewall (UFW) if installed.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "ufw disable",
        "cleanup_command": "ufw enable\nufw status verbose"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if ufw is installed on the machine.",
          "prereq_command": "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "fe135572-edcd-49a2-afe6-1d39521c5a9a"
    },
    {
      "name": "Stop/Start Packet Filter",
      "description": "Stop the Packet Filter if installed.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "service pf stop\nservice pf disable",
        "cleanup_command": "service pf enable\nservice pf start\nservice pf status"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if pfctl is installed on the machine.",
          "prereq_command": "if [ ! -x \"$(command -v pfctl)\" ]; then echo -e \"\\n***** PF NOT installed *****\\n\"; exit 1; fi\nif [ \"$(kldstat -n pf)\" = \"\" ]; then echo -e \"\\n***** PF inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "0ca82ed1-0a94-4774-9a9a-a2c83a8022b7"
    },
    {
      "name": "Stop/Start UFW firewall systemctl",
      "description": "Stop the Uncomplicated Firewall (UFW) if installed, using systemctl.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "systemctl stop ufw",
        "cleanup_command": "systemctl start ufw\nsystemctl status ufw"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if systemctl and ufw is installed on the machine.",
          "prereq_command": "if [ ! -x \"$(command -v systemctl)\" ]; then echo -e \"\\n***** systemctl NOT installed *****\\n\"; exit 1; fi\nif [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "9fd99609-1854-4f3c-b47b-97d9a5972bd1"
    },
    {
      "name": "Turn off UFW logging",
      "description": "Turn off the Uncomplicated Firewall (UFW) logging.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "ufw logging off",
        "cleanup_command": "ufw logging low\nufw status verbose"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if ufw is installed on the machine and enabled.",
          "prereq_command": "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "8a95b832-2c2a-494d-9cb0-dc9dd97c8bad"
    },
    {
      "name": "Add and delete UFW firewall rules",
      "description": "Add and delete a rule on the Uncomplicated Firewall (UFW) if installed and enabled.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "ufw prepend deny from 1.2.3.4\nufw status numbered",
        "cleanup_command": "{ echo y; echo response; } | ufw delete 1\nufw status numbered"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if ufw is installed on the machine and enabled.",
          "prereq_command": "if [ ! -x \"$(command -v ufw)\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi\nif echo \"$(ufw status)\" |grep -q \"inactive\"; then echo -e \"\\n***** ufw inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "b2563a4e-c4b8-429c-8d47-d5bcb227ba7a"
    },
    {
      "name": "Add and delete Packet Filter rules",
      "description": "Add and delete a rule on the Packet Filter (PF) if installed and enabled.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "echo \"block in proto tcp from 1.2.3.4 to any\" | pfctl -a pf-rules -f -\npfctl -a pf-rules -s rules",
        "cleanup_command": "pfctl -a pf-rules -F rules\nsed -i \"\" '/anchor pf-rules/d'\npfctl -f /etc/pf.conf"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if pf is installed on the machine and enabled.",
          "prereq_command": "if [ ! -x \"$(command -v pfctl)\" ]; then echo -e \"\\n***** PF NOT installed *****\\n\"; exit 1; fi\nif [ \"$(kldstat -n pf)\" = \"\" ]; then echo -e \"\\n***** PF inactive *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"anchor pf-rules >> /etc/pf.conf\"\npfctl -f /etc/pf.conf"
        }
      ],
      "auto_generated_guid": "8b23cae1-66c1-41c5-b79d-e095b6098b5b"
    },
    {
      "name": "Edit UFW firewall user.rules file",
      "description": "Edit the Uncomplicated Firewall (UFW) rules file /etc/ufw/user.rules.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "echo \"# THIS IS A COMMENT\" >> /etc/ufw/user.rules\ngrep \"# THIS IS A COMMENT\" /etc/ufw/user.rules",
        "cleanup_command": "sed -i 's/# THIS IS A COMMENT//g' /etc/ufw/user.rules"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if /etc/ufw/user.rules exists.",
          "prereq_command": "if [ ! -f \"/etc/ufw/user.rules\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "beaf815a-c883-4194-97e9-fdbbb2bbdd7c"
    },
    {
      "name": "Edit UFW firewall ufw.conf file",
      "description": "Edit the Uncomplicated Firewall (UFW) configuration file /etc/ufw/ufw.conf \nwhich controls if the firewall starts on boot and its logging level.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "echo \"# THIS IS A COMMENT\" >> /etc/ufw/ufw.conf\ngrep \"# THIS IS A COMMENT\" /etc/ufw/ufw.conf",
        "cleanup_command": "sed -i 's/# THIS IS A COMMENT//g' /etc/ufw/ufw.conf\ncat /etc/ufw/ufw.conf"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if /etc/ufw/ufw.conf exists.",
          "prereq_command": "if [ ! -f \"/etc/ufw/ufw.conf\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "c1d8c4eb-88da-4927-ae97-c7c25893803b"
    },
    {
      "name": "Edit UFW firewall sysctl.conf file",
      "description": "Edit the Uncomplicated Firewall (UFW) configuration file for setting network \nvariables /etc/ufw/sysctl.conf.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "echo \"# THIS IS A COMMENT\" >> /etc/ufw/sysctl.conf\ngrep \"# THIS IS A COMMENT\" /etc/ufw/sysctl.conf",
        "cleanup_command": "sed -i 's/# THIS IS A COMMENT//g' /etc/ufw/sysctl.conf\ncat /etc/ufw/sysctl.conf"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if /etc/ufw/sysctl.conf exists.",
          "prereq_command": "if [ ! -f \"/etc/ufw/sysctl.conf\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "c4ae0701-88d3-4cd8-8bce-4801ed9f97e4"
    },
    {
      "name": "Edit UFW firewall main configuration file",
      "description": "Edit the Uncomplicated Firewall (UFW) main configuration file for setting \ndefault policies /etc/default/ufw.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "echo \"# THIS IS A COMMENT\" >> /etc/default/ufw\ngrep \"# THIS IS A COMMENT\" /etc/default/ufw",
        "cleanup_command": "sed -i 's/# THIS IS A COMMENT//g' /etc/default/ufw"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if /etc/default/ufw exists.",
          "prereq_command": "if [ ! -f \"/etc/default/ufw\" ]; then echo -e \"\\n***** ufw NOT installed *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "7b697ece-8270-46b5-bbc7-6b9e27081831"
    },
    {
      "name": "Tail the UFW firewall log file",
      "description": "Print  the last 10 lines of the Uncomplicated Firewall (UFW) log file \n/var/log/ufw.log.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "tail /var/log/ufw.log"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if /var/log/ufw.log exists.",
          "prereq_command": "if [ ! -f \"/var/log/ufw.log\" ]; then echo -e \"\\n***** ufw NOT logging *****\\n\"; exit 1; fi",
          "get_prereq_command": "echo \"\""
        }
      ],
      "auto_generated_guid": "419cca0c-fa52-4572-b0d7-bc7c6f388a27"
    },
    {
      "name": "Disable iptables",
      "description": "Some Linux systems may not activate ufw, but use iptables for firewall rules instead. (ufw works on top of iptables.) \nAttackers cannot directly disable iptables, as it is not implemented as a service like ufw. But they can flush all iptables \nrules, which in fact \"disable\" iptables.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "iptables-save > /tmp/iptables.rules\niptables -F",
        "cleanup_command": "iptables-restore < /tmp/iptables.rules"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if iptables is installed on the machine.",
          "prereq_command": "if [ ! -x \"$(command -v iptables)\" ]; then echo -e \"\\n***** iptables NOT installed *****\\n\"; exit 1; fi",
          "get_prereq_command": "sudo apt-get install iptables"
        }
      ],
      "auto_generated_guid": "7784c64e-ed0b-4b65-bf63-c86db229fd56"
    },
    {
      "name": "Modify/delete iptables firewall rules",
      "description": "Instead of completely \"disabling\" iptables, adversaries may choose to delete a certain rule, which, for example, blocks data exfiltration via ftp.\nBy doing so, they may cause less noise to avoid detection.",
      "supported_platforms": [
        "linux"
      ],
      "executor": {
        "name": "sh",
        "elevation_required": true,
        "command": "iptables -D OUTPUT -p tcp --dport 21 -j DROP",
        "cleanup_command": "iptables-restore < /tmp/iptables.rules"
      },
      "input_arguments": {},
      "dependencies": [
        {
          "description": "Check if iptables is installed on the machine.",
          "prereq_command": "if [ ! -x \"$(command -v iptables)\" ]; then echo -e \"\\n***** iptables NOT installed *****\\n\"; exit 1; fi\nif ! echo \"$(iptables -L)\" | grep -q \"DROP .*dpt:ftp\"; then echo -e \"\\n***** this firewall rule is NOT activated *****\\n***** activate it by executing \\\"iptables -A OUTPUT -p tcp --dport 21 -j DROP\\\" *****\\n\"; exit 1; fi",
          "get_prereq_command": "iptables-save > /tmp/iptables.rules\nif echo \"$(iptables -L)\" | grep -q \"DROP .*dpt:ftp\"; then echo \"Rule found\"; else echo \"Rule not found. Setting it...\"; iptables -A OUTPUT -p tcp --dport 21 -j DROP; fi"
        }
      ],
      "auto_generated_guid": "899a7fb5-d197-4951-8614-f19ac4a73ad4"
    },
    {
      "name": "LockBit Black - Unusual Windows firewall registry modification -cmd",
      "description": "An adversary tries to modify the windows firewall registry",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "command": "reg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\" /v EnableFirewall /t REG_DWORD /d 0 /f\nreg add \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" /v EnableFirewall /t REG_DWORD /d 0 /f",
        "cleanup_command": "reg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\" /v EnableFirewall /f >nul 2>&1\nreg delete \"HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" /v EnableFirewall /f >nul 2>&1"
      },
      "input_arguments": {},
      "auto_generated_guid": "a4651931-ebbb-4cde-9363-ddf3d66214cb"
    },
    {
      "name": "LockBit Black - Unusual Windows firewall registry modification -Powershell",
      "description": "An adversary tries to modify the windows firewall registry.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "New-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force\nNew-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force",
        "cleanup_command": "Remove-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\"  -Name EnableFirewall -Force -ErrorAction Ignore\nRemove-ItemProperty \"HKLM:\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\StandardProfile\" -Name EnableFirewall -Force -ErrorAction Ignore"
      },
      "input_arguments": {},
      "auto_generated_guid": "80b453d1-eec5-4144-bf08-613a6c3ffe12"
    },
    {
      "name": "Blackbit - Disable Windows Firewall using netsh firewall",
      "description": "An adversary tries to modify the windows firewall configuration using the deprecated netsh firewall command (command still works).",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": true,
        "command": "netsh firewall set opmode mode=disable",
        "cleanup_command": "netsh firewall set opmode mode=enable >nul 2>&1"
      },
      "input_arguments": {},
      "auto_generated_guid": "91f348e6-3760-4997-a93b-2ceee7f254ee"
    },
    {
      "name": "ESXi - Disable Firewall via Esxcli",
      "description": "Adversaries may disable the ESXI firewall via ESXCLI",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "#{plink_file} -ssh #{vm_host} -l #{username} -pw #{password} -m PathToAtomicsFolder\\..\\atomics\\T1562.004\\src\\esxi_disable_firewall.txt",
        "cleanup_command": "#{plink_file} -ssh #{vm_host} -l #{username} -pw #{password} -m PathToAtomicsFolder\\..\\atomics\\T1562.004\\src\\esxi_enable_firewall.txt"
      },
      "input_arguments": {
        "vm_host": {
          "description": "Specify the host name of the ESXi Server",
          "type": "string",
          "default": "atomic.local"
        },
        "plink_file": {
          "description": "Path to Putty",
          "type": "path",
          "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\plink.exe"
        },
        "username": {
          "description": "username used to log into ESXi",
          "type": "string",
          "default": "root"
        },
        "password": {
          "description": "password used to log into ESXI",
          "type": "string",
          "default": "n/a"
        }
      },
      "dependencies": [
        {
          "description": "The plink executable must be found in the ExternalPayloads folder.",
          "prereq_command": "if (Test-Path \"#{plink_file}\") {exit 0} else {exit 1}",
          "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe\" -OutFile \"#{plink_file}\""
        }
      ],
      "dependency_executor_name": "powershell",
      "auto_generated_guid": "bac8a340-be64-4491-a0cc-0985cb227f5a"
    },
    {
      "name": "Set a firewall rule using New-NetFirewallRule",
      "description": "This test will attempt to create a new inbound/outbound firewall rule using the New-NetFirewallRule commandlet.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "powershell",
        "elevation_required": true,
        "command": "New-NetFirewallRule -DisplayName \"New rule\" -Direction \"#{direction}\" -LocalPort \"#{local_port}\" -Protocol \"#{protocol}\" -Action \"#{action}\"",
        "cleanup_command": "Remove-NetFirewallRule -DisplayName \"New rule\""
      },
      "input_arguments": {
        "direction": {
          "description": "Direction can be Inbound or Outbound",
          "type": "string",
          "default": "Inbound"
        },
        "local_port": {
          "description": "This is the local port you wish to test opening",
          "type": "integer",
          "default": "21"
        },
        "protocol": {
          "description": "This is the protocol",
          "type": "string",
          "default": "TCP"
        },
        "action": {
          "description": "This is the action",
          "type": "string",
          "default": "allow"
        }
      },
      "auto_generated_guid": "94be7646-25f6-467e-af23-585fb13000c8"
    },
    {
      "name": "ESXi - Set Firewall to PASS Traffic",
      "description": "This test sets the default ESXi firewall action to PASS instead of DROP. This allows all incoming and outgoing traffic.",
      "supported_platforms": [
        "windows"
      ],
      "executor": {
        "name": "command_prompt",
        "elevation_required": false,
        "command": "echo \"\" | \"#{plink_file}\" -batch \"#{vm_host}\" -ssh -l #{vm_user} -pw \"#{vm_pass}\" \"esxcli network firewall set --default-action true\"",
        "cleanup_command": "echo \"\" | \"#{plink_file}\" -batch \"#{vm_host}\" -ssh -l #{vm_user} -pw \"#{vm_pass}\" \"esxcli network firewall set --default-action false\""
      },
      "input_arguments": {
        "vm_host": {
          "description": "Specify the host name or IP of the ESXi server.",
          "type": "string",
          "default": "atomic.local"
        },
        "vm_user": {
          "description": "Specify the privilege user account on the ESXi server.",
          "type": "string",
          "default": "root"
        },
        "vm_pass": {
          "description": "Specify the privileged user's password.",
          "type": "string",
          "default": "password"
        },
        "plink_file": {
          "description": "Path to Plink",
          "type": "path",
          "default": "PathToAtomicsFolder\\..\\ExternalPayloads\\plink.exe"
        }
      },
      "dependencies": [
        {
          "description": "The plink executable must be found in the ExternalPayloads folder.",
          "prereq_command": "if (Test-Path \"#{plink_file}\") {exit 0} else {exit 1}",
          "get_prereq_command": "New-Item -Type Directory \"PathToAtomicsFolder\\..\\ExternalPayloads\\\" -ErrorAction Ignore -Force | Out-Null\nInvoke-WebRequest \"https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe\" -OutFile \"#{plink_file}\""
        }
      ],
      "dependency_executor_name": "powershell",
      "auto_generated_guid": "a67e8aea-ea7c-4c3b-9b1b-8c2957c3091d"
    }
  ]
}